@startuml
actor 用户

'
' 初始化系统，显示初始界面状态
usecase "启动图形编辑器" as 启动
'
' 创建不同类型的图形
usecase "创建直线" as 创建直线
usecase "创建椭圆" as 创建椭圆
usecase "创建矩形" as 创建矩形
'
' 选择图形（单选、多选、取消选择）
usecase "选择图形" as 选择图形
'
' 删除已选择的图形
usecase "删除图形" as 删除图形
'
' 改变图形尺寸（通过控制点拖动或按钮操作）
usecase "改变图形尺寸" as 改变尺寸
usecase "使用放大按钮调整尺寸" as 放大图形
usecase "使用缩小按钮调整尺寸" as 缩小图形
'
' 移动图形位置
usecase "移动图形" as 移动图形
'
' 图层管理相关功能
usecase "创建新图层" as 创建新图层
usecase "切换图层" as 切换图层

'---------------------------------
' 关联：用户与用例之间的交互
'---------------------------------
用户 --> 启动
用户 --> 创建直线
用户 --> 创建椭圆
用户 --> 创建矩形
用户 --> 选择图形
用户 --> 删除图形
用户 --> 改变尺寸
用户 --> 放大图形
用户 --> 缩小图形
用户 --> 移动图形
用户 --> 创建新图层
用户 --> 切换图层

'---------------------------------
' 包含关系（include）：强制依赖
'---------------------------------

' 启动时必须初始化默认图层和提示信息
' 因果说明：启动编辑器时必须自动创建第一个图层并设置提示
启动 ..> 创建新图层 : <<include>>

' 创建图形前必须选择图形类型，且所有创建操作都基于当前图层
' 因果说明：创建任何图形都必须在当前图层上进行
创建直线 ..> 选择图形 : <<include>>
创建椭圆 ..> 选择图形 : <<include>>
创建矩形 ..> 选择图形 : <<include>>

' 改变尺寸可以通过拖动控制点或点击按钮实现
' 因果说明：使用按钮放大是改变尺寸的一种方式
放大图形 ..> 改变尺寸 : <<include>>
' 因果说明：使用按钮缩小也是改变尺寸的一种方式
缩小图形 ..> 改变尺寸 : <<include>>

' 删除图形前必须先选择图形
' 因果说明：删除操作依赖于已有被选中的图形
删除图形 ..> 选择图形 : <<include>>

' 移动图形前必须选择图形
' 因果说明：移动操作只能作用于已选择的图形
移动图形 ..> 选择图形 : <<include>>

'---------------------------------
' 扩展关系（extend）：条件性扩展
'---------------------------------

' 当图层数未达上限时才能创建新图层
' 触发条件：当图层数小于16时，“创建新图层”才可执行
创建新图层 <-- 拓展_图层未满 : <<extend>>\n<<guard>>: 图层数 < 16
note on link
  扩展点：检查图层数量是否超过16
end note

' 图形创建种类未来可扩展（如多边形等）
' 触发条件：系统支持未来添加新的图形类型
创建直线 <-- 拓展_扩展图形类型 : <<extend>>\n<<stub>>
创建椭圆 <-- 拓展_扩展图形类型 : <<extend>>\n<<stub>>
创建矩形 <-- 拓展_扩展图形类型 : <<extend>>\n<<stub>>
note right of 拓展_扩展图形类型
  约束(1)：图形编辑器可在创建的图形种类上扩展
  例如后续可加入多边形、曲线等
end note

' 切换图层时若已是最后一页则跳转到第一页
' 触发条件：当前图层为最后一个图层时，“下一页”触发循环切换
切换图层 <-- 拓展_循环切换图层 : <<extend>>\n<<guard>>: 当前图层 = 最后一个
note on link
  扩展点：点击“下一页”且当前为末页时跳回首页
end note

@enduml
