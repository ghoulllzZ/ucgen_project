@startuml
actor 用户

'
' 初始化与启动行为
'
用户 --> (软件初始启动)
(软件初始启动)

'
' 图层管理相关用例
'
用户 --> (创建图层)
(创建图层) --> (管理图层) : include
' 创建新图层时必须进行图层管理状态初始化
(创建图层) ..|> (管理图层)
note on link: 新图层创建后自动成为当前图层

用户 --> (管理图层)
(管理图层) --> (切换当前图层) : include
' 切换图层是管理图层的一部分功能
(切换当前图层)

'
' 图形操作主用例
'
用户 --> (创建图形)
' 用户从工具栏选择形状并在编辑区绘制
(创建图形) --> (选择图形类型) : include
' 创建图形前必须选择图形类型（直线、椭圆、矩形）
(选择图形类型)

用户 --> (选择图形)
' 用户通过点击或框选选择一个或多个图形
(选择图形) --> (取消选择) : extend
' 当在空白区域点击时，触发取消所有选择状态
note "当在编辑区空白处点击\n则取消所有已选图形" on link

(选择图形) --> (多选图形) : extend
' 当拖动鼠标形成选择框时，触发多选机制
note "当拖动鼠标形成虚线矩形\n区域内所有图形被选中" on link

用户 --> (删除图形)
' 先选择图形，再点击删除按钮执行删除
(删除图形) --> (选择图形) : include
' 删除操作必须先有图形被选择
' 必须选择图形才能删除

用户 --> (改变图形尺寸)
' 通过拖动控制点或点击放大缩小按钮调整尺寸
(改变图形尺寸) --> (拖动控制点) : include
' 改变尺寸的一种方式：拖动角上的控制点
(改变图形尺寸) --> (点击放大按钮) : include
' 直接点击“放大”按钮实现等比放大
(改变图形尺寸) --> (点击缩小按钮) : include
' 直接点击“缩小”按钮实现等比缩小

用户 --> (移动图形)
' 在图形内部按下并拖动以移动位置
(移动图形)

'
' 系统状态与提示
'
(软件初始启动) --> (初始化编辑区域) : include
' 启动时创建第一个编辑图层
(软件初始启动) --> (初始化图形提示) : include
' 提示区域显示“第一页”
(软件初始启动) --> (默认选择矩形) : include
' 创建图形选择框默认显示矩形

(管理图层) --> (图层编号提示更新) : include
' 切换或新建图层时提示区域更新编号
(创建图层) --> (图层编号提示更新) : include

'
' 扩展约束体现
'
note right of (创建图形)
    可扩展支持更多图形类型
    如多边形、曲线等
end note

'
' 约束条件建模：最多16个图层
'
(创建图层) --> (检查图层数量) : include
' 创建前必须检查是否已达16层上限
(检查图层数量)
note "若图层数 ≥ 16\n则禁止创建新页" on (检查图层数量)

'
' 操作状态重置
'
(切换当前图层) --> (重置图形工具为矩形) : include
' 每次图层切换后，工具恢复为矩形创建状态
(创建图层) --> (重置图形工具为矩形) : include

@enduml
