@startuml
actor 用户 as User

' 软件初始启动时执行的初始化行为
usecase "初始化编辑器" as 初始化编辑器
User --> 初始化编辑器 : 启动软件

' 创建图形的基本流程
usecase "创建图形" as 创建图形
User --> 创建图形

' 选择图形功能，包括单选、多选和取消选择
usecase "选择图形" as 选择图形
User --> 选择图形

' 删除已选择的图形
usecase "删除图形" as 删除图形
User --> 删除图形

' 改变图形尺寸：通过拖动控制点或使用放大/缩小按钮
usecase "改变图形尺寸" as 改变图形尺寸
User --> 改变图形尺寸

' 移动已选择的图形到新位置
usecase "移动图形" as 移动图形
User --> 移动图形

' 创建新图层，最多16个
usecase "创建图层" as 创建图层
User --> 创建图层

' 在多个图层之间切换当前图层
usecase "管理图层（切换）" as 管理图层
User --> 管理图层

' 子功能：在编辑区域绘制图形
usecase "绘制所选图形" as 绘制所选图形

' 子功能：进入矩形创建状态
usecase "设置创建状态为矩形" as 设置创建状态为矩形

' 子功能：更新图层提示信息
usecase "显示图层编号提示" as 显示图层编号提示

' 初始化过程中必须包含默认图层和提示设置
' 因为启动后必须生成第一个图层并提示第一页
初始化编辑器 ..> 创建图层 : include
' 初始化时自动设置第一个图层并提示“第一页”
初始化编辑器 ..> 显示图层编号提示 : include

' 创建图形依赖于先选择图形类型，并在编辑区绘制
' 必须包含实际绘制动作
创建图形 ..> 绘制所选图形 : include
' 所有图层操作开始前都应处于“矩形”创建状态
创建图形 ..> 设置创建状态为矩形 : include

' 选择图形可能触发多选或取消选择
' 选择图形是独立主用例，无需include其他

' 删除图形前提是已选择图形
' 删除操作解除图形与图层关系
删除图形 ..> 选择图形 : extend
' <<extend>> 因为只有当图形被选中后才能触发删除
note on transition
  扩展条件：至少一个图形已被选中
end note

' 改变尺寸需要先选择图形及其控制点
' 或使用工具按钮直接缩放
改变图形尺寸 ..> 选择图形 : include
' 必须先选择图形才能改变其尺寸

' 移动图形也必须基于已选择的图形
移动图形 ..> 选择图形 : include
' 只有选中的图形才能被移动

' 创建图层会更新提示并设为当前层
创建图层 ..> 显示图层编号提示 : include
' 新图层创建时需提示编号
创建图层 ..> 设置创建状态为矩形 : include
' 每个新图层初始化为矩形创建状态

' 管理图层（切换）也会更新提示和重置创建状态
管理图层 ..> 显示图层编号提示 : include
' 切换图层时提示当前编号
管理图层 ..> 设置创建状态为矩形 : include
' 图层切换后操作状态回到“矩形”创建

' 约束：图形种类可扩展（预留扩展点）
' 假设未来可在绘制时支持更多图形类型
绘制所选图形 ..> "扩展：支持其他图形类型" as 扩展图形类型 : extend
' <<extend>> 条件：系统实现新的图形类型
note right of 扩展图形类型
  触发条件：新增图形类型（如三角形、多边形等）
  遵循约束：可在创建的图形种类上扩展
end note

@enduml
