@startuml
actor 用户 as User

' 软件初始启动时必须执行的初始化设置
User --> (软件初始启动)
(软件初始启动) .> (创建图形选择框显示矩形) : include
' 启动时必须创建第一个编辑图层
(软件初始启动) .> (创建第一个编辑图层) : include
' 启动时提示区域必须显示“第一页”
(软件初始启动) .> (图形提示区域提示第一页) : include

' 创建图形是用户在当前图层上进行的基本操作
User --> (创建图形)
' 创建图形过程中必须使用当前图层作为宿主
(创建图形) .> (编辑区域当前图层) : include
' 创建图形依赖于从选择框中选定一种图形类型
(创建图形) .> (创建图形选择框显示矩形) : include

' 选择图形功能允许单选、多选或取消选择
User --> (选择图形)
' 选择图形发生在当前图层的图形上
(选择图形) .> (编辑区域当前图层) : include
' 图形选择状态通过控制点高亮表示
(选择图形) .> (图形控制点高亮显示) : include

' 删除图形前必须先选择图形，并点击删除按钮
User --> (删除图形)
' 删除图形的前提是已有被选择的图形
(删除图形) .> (选择图形) : include
' 删除操作解除图形与当前图层的隶属关系
(删除图形) .> (编辑区域当前图层) : extend
' 扩展点：当点击“删除元素”按钮且存在已选图形时触发删除

' 改变图形尺寸可通过拖动控制点实现
User --> (改变图形尺寸)
' 改变尺寸需要先选择一个图形及其控制点
(改变图形尺寸) .> (选择图形) : include
(改变图形尺寸) .> (图形控制点高亮显示) : include
' 用户拖动控制点以调整大小
(改变图形尺寸) .> (拖动控制点调整尺寸) : include

' 使用放大/缩小按钮可直接调整选中图形尺寸
User --> (放大图形)
User --> (缩小图形)
' 放大和缩小都要求图形已被选择
(放大图形) .> (选择图形) : include
(缩小图形) : include
' 按钮操作扩展了改变尺寸的方式
(放大图形) .> (改变图形尺寸) : extend
' 扩展点：当点击“放大”按钮且有图形被选中时触发
(缩小图形) .> (改变图形尺寸) : extend
' 扩展点：当点击“缩小”按钮且有图形被选中时触发

' 移动图形功能允许拖动已选图形到新位置
User --> (移动图形)
' 移动图形的前提是图形已被选择
(移动图形) .> (选择图形) : include
' 移动时不改变图层和控制点状态
(移动图形) .> (保持图层与控制点状态) : include

' 创建新图层会增加图层数量并切换为当前图层
User --> (创建图层)
' 创建图层受最大数量限制（16个）
(创建图层) .> (图层数量不超过16) : include
' 新图层创建后自动成为当前图层
(创建图层) .> (编辑区域当前图层) : include
' 创建图层后提示区域更新编号
(创建图层) .> (图形提示区域提示当前层编号) : include
' 新图层初始化为矩形创建状态
(创建图层) .> (创建图形选择框显示矩形) : include

' 管理图层包括切换前后图层
User --> (管理图层)
' 切换图层时更新当前图层
(管理图层) .> (编辑区域当前图层) : include
' 切换后提示当前层编号
(管理图层) .> (图形提示区域提示当前层编号) : include
' 切换后重置为矩形创建状态
(管理图层) .> (创建图形选择框显示矩形) : include
' 特殊行为：到最后图层再切则回到第一层
(管理图层) .> (循环切换图层) : extend
' 扩展点：当当前为最后一页时，“下一页”跳转至第一页

' 可扩展支持更多图形类型（约束条件）
(创建图形) .> (扩展图形种类) : extend
' 扩展点：未来可在直线、椭圆、矩形基础上添加其他图形类型

' 定义基础用例与组件
usecase "软件初始启动" as 软件初始启动
usecase "创建图形选择框显示矩形" as 创建图形选择框显示矩形
usecase "创建第一个编辑图层" as 创建第一个编辑图层
usecase "图形提示区域提示第一页" as 图形提示区域提示第一页
usecase "创建图形" as 创建图形
usecase "编辑区域当前图层" as 编辑区域当前图层
usecase "选择图形" as 选择图形
usecase "图形控制点高亮显示" as 图形控制点高亮显示
usecase "删除图形" as 删除图形
usecase "改变图形尺寸" as 改变图形尺寸
usecase "拖动控制点调整尺寸" as 拖动控制点调整尺寸
usecase "放大图形" as 放大图形
usecase "缩小图形" as 缩小图形
usecase "移动图形" as 移动图形
usecase "保持图层与控制点状态" as 保持图层与控制点状态
usecase "创建图层" as 创建图层
usecase "图层数量不超过16" as 图层数量不超过16
usecase "图形提示区域提示当前层编号" as 图形提示区域提示当前层编号
usecase "管理图层" as 管理图层
usecase "循环切换图层" as 循环切换图层
usecase "扩展图形种类" as 扩展图形种类

@enduml
