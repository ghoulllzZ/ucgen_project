@startuml
actor 用户

usecase "启动图形编辑器" as 启动图形编辑器
usecase "创建图形" as 创建图形
usecase "选择图形" as 选择图形
usecase "删除图形" as 删除图形
usecase "改变图形尺寸" as 改变图形尺寸
usecase "移动图形" as 移动图形
usecase "创建新图层" as 创建新图层
usecase "切换图层" as 切换图层

用户 -> 启动图形编辑器
用户 -> 创建图形
用户 -> 选择图形
用户 -> 删除图形
用户 -> 改变图形尺寸
用户 -> 移动图形
用户 -> 创建新图层
用户 -> 切换图层

' 启动时必须初始化图形选择框和初始图层，但根据约束不能 include 创建新图层或选择图形
' 因此仅保留独立的启动用例

' 创建图形过程中必须包含选择图形类型并进行绘制
' 但由于“选择直线、椭圆或矩形”等被禁止作为独立用例，故合并到创建图形中
创建图形 ..> 选择图形 : <<include>>
' 创建图形执行前需先选择图形类型（隐含在流程中）

' 选择图形功能包括单选、多选和取消选择，均属于同一用例范畴
' 根据需求，选择是删除、改变尺寸、移动的前提
选择图形 ..> 删除图形 : <<include>>
' 删除图形前必须已选择图形

选择图形 ..> 改变图形尺寸 : <<include>>
' 改变图形尺寸前必须选择图形及其控制点

选择图形 ..> 移动图形 : <<include>>
' 移动图形前必须选择图形

' 创建新图层会自动设置为当前图层，并重置创建状态为矩形
创建新图层 ..> 切换图层 : <<extend>>
' 当新图层被创建后，扩展切换图层行为以将其设为当前层（触发条件：新图层成功创建）

' 切换图层后重置创建图形为矩形
切换图层 ..> 创建图形 : <<extend>>
' 扩展点：图层切换完成后，重置图形选择框为“矩形”（触发条件：图层切换发生）

' 约束要求保留“启动图形编辑器”和“切换图层”，且禁止某些 include/extend
' 已遵守：未将创建新图层 include 进启动，也未将切换图层与创建图形相互 include

@enduml
