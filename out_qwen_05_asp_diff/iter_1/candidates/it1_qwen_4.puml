@startuml
actor 用户

'
' 启动系统后初始化界面状态
用户 --> (启动图形编辑器)
(启动图形编辑器) ..> (显示初始图层) : include
' 系统必须创建第一个编辑图层
(启动图形编辑器) ..> (设置初始图形选择) : include
' 创建图形选择框默认显示矩形
(启动图形编辑器) ..> (提示第一页) : include
' 图形提示区域提示“第一页”

'
' 图形创建功能主用例
用户 --> (创建图形)
' 用户从选择框选中一种图形并在编辑区拖拽绘制
(创建图形) ..> (选择图形类型) : include
' 必须先选择直线、椭圆或矩形中的一种
(创建图形) ..> (在编辑区绘制图形) : include
' 绘制过程包含起始点按下、拖动虚线预览、释放完成绘制
(创建图形) ..> (将图形隶属当前图层) : include
' 新建图形必须隶属于当前图层

'
' 图形选择功能支持单选、多选和取消选择
用户 --> (选择图形)
' 在图形内部点击选择单个图形
(选择图形) ..> (高亮控制点) : include
' 选择后外嵌矩形四角高亮显示控制点
(选择图形) ..> (支持图形叠加选择) : include
' 叠加部分点击可选择多个图形
(选择图形) ..> (矩形区域多选) : include
' 按下拖动释放形成虚线矩形，区域内所有图形被选中
(选择图形) ..> (取消所有选择) : include
' 在空白处点击取消之前的选择状态

'
' 删除图形依赖于先选择图形
用户 --> (删除图形)
' 点击“删除元素”按钮删除所选图形
(删除图形) ..> (已选择图形) : include
' 必须已有图形被选中才能执行删除
(删除图形) ..> (解除图形隶属关系) : include
' 从当前图层移除图形的隶属关系以实现删除

'
' 改变图形尺寸可通过拖动控制点或使用按钮
用户 --> (改变图形尺寸)
(改变图形尺寸) ..> (拖动控制点调整尺寸) : include
' 选择控制点并拖动鼠标改变图形大小
(改变图形尺寸) ..> (点击放大按钮) : include
' “放大”按钮直接放大所选图形
(改变图形尺寸) ..> (点击缩小按钮) : include
' “缩小”按钮直接缩小所选图形

'
' 移动图形功能
用户 --> (移动图形)
' 在图形内部按下并拖动至新位置
(移动图形) ..> (保持控制点状态) : include
' 拖动过程中选择状态和控制点高亮保持不变
(移动图形) ..> (更新图形位置) : include
' 将图形坐标更新到新位置

'
' 创建新图层功能
用户 --> (创建图层)
' 点击“新页”按钮生成新图层
(创建图层) ..> (检查图层数量限制) : include
' 若图层数 ≥16，则禁止创建（约束性前置条件）
(创建图层) ..> (创建新图层实例) : include
' 实际创建新的图层对象
(创建图层) ..> (设为当前图层) : include
' 新图层自动成为当前操作图层
(创建图层) ..> (提示新图层编号) : include
' 图形提示区域显示新图层编号
(创建图层) ..> (重置图形选择状态为矩形) : include
' 工具区域创建图形选择框恢复为“矩形”

'
' 管理图层包括切换图层
用户 --> (管理图层)
' 点击“下一页”按钮进行图层切换
(管理图层) ..> (切换当前图层) : include
' 将下一图层设为当前图层，若已是最后一个则切回第一个
(管理图层) ..> (提示当前图层编号) : include
' 图形提示区域更新为当前图层编号
(管理图层) ..> (重置图形选择状态为矩形) : include
' 切换后图形工具恢复为“矩形”选择状态

'
' 扩展可能性（根据约束：可在创建的图形种类上扩展）
' 注释说明而非实际用例关系，因无具体触发条件要求
' (创建图形) <|.. (扩展支持其他图形类型) : extend
' 当新增图形类型（如三角形、多边形）时对创建图形功能进行扩展

@enduml
