@startuml
actor 用户

'
' 启动时初始化界面和默认图层
'
用户 --> (启动图形编辑器)
(启动图形编辑器) --> (创建默认图层) : include
' 必须创建第一个图层以支持后续操作
(启动图形编辑器) --> (显示初始图形选择) : include
' 创建图形选择框默认显示“矩形”
(启动图形编辑器) --> (提示第一页) : include
' 图形提示区域初始提示为“第一页”

'
' 图形创建功能
'
用户 --> (创建图形)
(创建图形) --> (选择图形类型) : include
' 用户必须先选择直线、椭圆或矩形之一
(创建图形) --> (在编辑区域绘制图形) : include
' 按下拖动释放完成绘制虚线框内图形
(创建图形) --> (将图形隶属当前图层) : include
' 新建图形必须隶属于当前图层

'
' 图形选择功能
'
用户 --> (选择图形)
(选择图形) --> (单击图形内部) : include
' 单个点击选择一个图形，控制点高亮
(选择图形) --> (多选图形) : include
' 通过叠加点击或拖拽虚线框选多个图形
(选择图形) --> (取消选择) : include
' 在空白处点击取消所有已选图形

'
' 删除图形功能
'
用户 --> (删除图形)
' 必须先选择图形才能删除
(删除图形) .> (选择图形) : extend
' 扩展点：当图形已被选中后，点击“删除元素”按钮触发删除

'
' 改变图形尺寸功能
'
用户 --> (改变图形尺寸)
(改变图形尺寸) --> (拖动控制点调整尺寸) : include
' 选择控制点拖动实现拉伸缩放
(改变图形尺寸) --> (使用放大缩小按钮) : include
' 点击“放大”或“缩小”按钮直接调整尺寸

'
' 移动图形功能
'
用户 --> (移动图形)
' 在选择图形内部按下并拖动实现移动
(移动图形) .> (选择图形) : extend
' 扩展点：仅当图形已被选中时才可拖动移动
(移动图形) --> (保持状态不变) : include
' 整个编辑器移动时图层与控制点状态保持

'
' 创建图层功能
'
用户 --> (创建新图层)
' 点击“新页”按钮创建新图层
(创建新图层) --> (检查图层数量上限) : include
' 若图层数 ≥16，则禁止创建
(创建新图层) --> (设置新图层为当前图层) : include
' 新图层自动成为当前操作图层
(创建新图层) --> (提示新图层编号) : include
' 图形提示区域显示新图层编号
(创建新图层) --> (重置图形选择为矩形) : include
' 创建图形选择框恢复为“矩形”

'
' 管理图层（图层切换）
'
用户 --> (切换图层)
' 点击“下一页”按钮进行图层切换
(切换图层) --> (选择目标图层作为当前层) : include
' 将选定图层设为当前编辑图层
(切换图层) --> (提示当前图层编号) : include
' 图形提示区域更新为当前层编号
(切换图层) --> (循环切换至首层) : include
' 若当前为最后一层，则切回第一层
(切换图层) --> (重置图形选择为矩形) : include
' 切换后操作状态恢复为创建“矩形”状态

@enduml
