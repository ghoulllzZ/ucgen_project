@startuml
actor 用户

'
' 启动与初始状态
'
usecase "启动图形编辑器" as 启动图形编辑器
usecase "创建图层" as 创建图层
usecase "管理图层" as 管理图层
usecase "选择图形" as 选择图形
usecase "删除图形" as 删除图形
usecase "调整图形尺寸" as 调整图形尺寸
usecase "移动图形" as 移动图形
usecase "创建图形" as 创建图形

'
' 细化用例（根据约束保留必要项）
'
usecase "拖动控制点调整尺寸" as 拖动控制点调整尺寸

'
' 关联关系：用户触发的顶层用例
'
用户 --> 启动图形编辑器
用户 --> 创建图形
用户 --> 选择图形
用户 --> 删除图形
用户 --> 调整图形尺寸
用户 --> 移动图形
用户 --> 创建图层
用户 --> 管理图层

'
' include 关系（强制性依赖，按约束条件建模）
'

' 删除图形前必须选择图形
' 因果：删除操作的前提是已有被选中的图形
删除图形 ..> 选择图形 : <<include>>

' 调整尺寸前必须选择图形
' 因果：只有选中图形后才能调整其尺寸
调整图形尺寸 ..> 选择图形 : <<include>>

' 移动图形前必须选择图形
' 因果：未选中的图形无法被移动
移动图形 ..> 选择图形 : <<include>>

' 创建图层时需检查图层数量上限
' 因果：当图层数达到16时禁止创建新图层
创建图层 ..> "检查图层数量是否超过16" as check_layer_limit : <<include>>
note right of 创建图层
  若图层数 ≥16，则禁止创建
end note

'
' extend 关系（扩展行为，带条件说明）
'

' 拖动控制点是调整尺寸的一种方式，在特定交互下触发
' 扩展点：当用户已选择一个图形，并拖动其控制点时触发
拖动控制点调整尺寸 ..> 调整图形尺寸 : <<extend>>
note on link
  触发条件：鼠标按下并拖动图形的控制点
end note

'
' 其他结构化约束处理
'

' 根据约束，禁止将“拖动控制点调整尺寸”作为“调整图形尺寸”的 include
' 故采用 extend 表达其为一种可选实现路径而非必需步骤

' 创建图形不包含创建图层（禁止 include），且启动时不自动创建图层
' 初始图层由系统直接生成，但不属于“启动图形编辑器”用例的子步骤

' 图形类型扩展受约束限制，不可显式建模为用例
' 约束：(创建图形) 不包含 (扩展支持的图形类型)，且禁止 extend

@enduml
