@startuml
actor 用户

'
' 启动时初始化界面状态
'
用户 --> (启动图形编辑器)
(启动图形编辑器) ..> (创建初始图层) : include
' 启动时必须创建第一个编辑图层
(启动图形编辑器) ..> (显示第一页提示) : include
' 启动时图形提示区域应提示“第一页”
(启动图形编辑器) ..> (设置创建图形为矩形) : include
' 初始时创建图形选择框显示矩形

'
' 创建图形功能
'
用户 --> (创建图形)
(创建图形) ..> (选择图形类型) : include
' 必须先选择直线、椭圆或矩形类型
(创建图形) ..> (在编辑区域绘制图形) : include
' 绘制过程是创建图形的必要步骤
(创建图形) --|> (扩展图形种类) : extend
' <<扩展点：当支持新图形类型时触发>>
' 图形编辑器可在创建的图形种类上扩展

'
' 选择图形功能
'
用户 --> (选择图形)
(选择图形) ..> (单选图形) : include
' 点击图形内部实现单选
(选择图形) ..> (多选图形) : include
' 支持叠加选择或拖拽框选多个图形
(选择图形) ..> (取消选择) : include
' 在空白处点击取消所有选择

'
' 删除图形功能
'
用户 --> (删除图形)
(删除图形) ..> (选择图形) : include
' 必须先选择图形才能删除
' 包含关系表示删除前必须完成选择

'
' 改变图形尺寸功能
'
用户 --> (改变图形尺寸)
(改变图形尺寸) ..> (拖动控制点调整尺寸) : include
' 通过拖动控制点直接改变尺寸
(改变图形尺寸) ..> (点击放大按钮) : include
' 放大所选图形
(改变图形尺寸) ..> (点击缩小按钮) : include
' 缩小所选图形

'
' 移动图形功能
'
用户 --> (移动图形)
' 用户可以直接在选择图形内部拖动来移动图形
(移动图形) .>> (保持图层状态) : extend
' 扩展点：当整个编辑器移动时，当前图层和控制点状态保持不变

'
' 创建图层功能
'
用户 --> (创建新图层)
(创建新图层) ..> (检查图层数量是否超限) : include
' 检查是否已有16个图层
(创建新图层) --|> (无法创建新图层) : extend
' 条件：图层数量超过16个时无法创建
(创建新图层) ..> (设置新图层为当前图层) : include
' 新图层被自动设为当前操作图层
(创建新图层) ..> (提示新图层编号) : include
' 图形提示区域显示新页编号
(创建新图层) ..> (设置创建图形为矩形) : include
' 新图层创建后默认处于矩形创建状态

'
' 管理图层功能
'
用户 --> (切换图层)
(切换图层) ..> (选择目标图层作为当前层) : include
' 将选定图层激活为当前编辑图层
(切换图层) ..> (更新图层编号提示) : include
' 提示区域同步显示当前图层编号
(切换图层) ..> (循环切换至首层) : extend
' 条件：当前为最后一页时，点击下一页回到第一页
(切换图层) ..> (重置为矩形创建状态) : include
' 每次图层切换后恢复为矩形创建模式

'
' 辅助用例（被包含）
'
usecase (启动图形编辑器) as UC1
usecase (创建初始图层) as UC2
usecase (显示第一页提示) as UC3
usecase (设置创建图形为矩形) as UC4

usecase (创建图形) as UC5
usecase (选择图形类型) as UC6
usecase (在编辑区域绘制图形) as UC7
usecase (扩展图形种类) as UC8

usecase (选择图形) as UC9
usecase (单选图形) as UC10
usecase (多选图形) as UC11
usecase (取消选择) as UC12

usecase (删除图形) as UC13

usecase (改变图形尺寸) as UC14
usecase (拖动控制点调整尺寸) as UC15
usecase (点击放大按钮) as UC16
usecase (点击缩小按钮) as UC17

usecase (移动图形) as UC18
usecase (保持图层状态) as UC19

usecase (创建新图层) as UC20
usecase (检查图层数量是否超限) as UC21
usecase (无法创建新图层) as UC22
usecase (设置新图层为当前图层) as UC23
usecase (提示新图层编号) as UC24

usecase (切换图层) as UC25
usecase (选择目标图层作为当前层) as UC26
usecase (更新图层编号提示) as UC27
usecase (循环切换至首层) as UC28
usecase (重置为矩形创建状态) as UC29

@enduml
