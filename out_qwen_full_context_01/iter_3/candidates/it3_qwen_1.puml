@startuml
actor 用户 as User

'
' 用例：创建与管理图形
'
usecase "创建图形" as create_shape
usecase "选择图形" as select_shape
usecase "删除图形" as delete_shape
usecase "改变图形尺寸" as resize_shape
usecase "移动图形" as move_shape

'
' 用例：图层管理
'
usecase "创建图层" as create_layer
usecase "管理图层" as manage_layer

'
' 用户与基本用例的关联
'
User --> create_shape : 创建基本图形
User --> select_shape : 选中一个或多个图形
User --> delete_shape : 删除已选中的图形
User --> create_layer : 添加新图层
User --> manage_layer : 切换当前图层

'
' include 关系（强制依赖）
'

' 创建图形必须基于当前图层的存在，但“创建图层”是独立入口点，此处不 include
' 选择图形是删除的前提，但根据约束 forbid_include 中禁止 select -> delete 的 include
' 因此使用 extend 模拟控制流，而非 include

'
' extend 关系（可选扩展）—— 基于需求中的扩展点 EP1 和 EP2
'

' 扩展点 EP1: 图形已被选中并显示控制点 → 改变尺寸
' 当用户拖动控制点或点击放大/缩小按钮时触发
select_shape ..> resize_shape : <<extend>>\n条件: 用户在控制点上拖动\n或点击“放大/缩小”按钮
note right of select_shape
  扩展点 EP1:
  图形已被选中并显示控制点
end note

' 扩展点 EP2: 图形已被选中 → 移动图形
' 当用户在已选图形内部按下并拖动时触发
select_shape ..> move_shape : <<extend>>\n条件: 用户在已选图形内部\n按下鼠标并拖动
note right of select_shape
  扩展点 EP2:
  图形已被选中
end note

'
' 约束处理说明：
' 根据【约束】，以下 include 被明确禁止：
' - 选择图形 --include--> 删除图形
' - 选择图形 --include--> 改变图形尺寸
' - 选择图形 --include--> 移动图形
' 故不使用箭头 <<include>>，而是通过 <<extend>> 表达扩展关系，符合语义且满足约束。
'

'
' 其他系统行为说明（非用例，不建模）：
' - 图形提示区域更新、工具栏重置为矩形等属于系统响应，不在用例图中体现
' - 最大图层数限制（16）属于业务规则，不影响用例结构
'

@enduml
