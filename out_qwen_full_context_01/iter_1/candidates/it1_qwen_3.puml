@startuml
actor 用户

'
' 基本用例
'
usecase "创建图形" as create_shape
usecase "选择图形" as select_shape
usecase "删除图形" as delete_shape
usecase "改变图形尺寸" as resize_shape
usecase "移动图形" as move_shape
usecase "创建图层" as create_layer
usecase "管理图层" as manage_layer

'
' 关联：用户与基本用例
'
用户 --> create_shape
用户 --> select_shape
用户 --> delete_shape
用户 --> create_layer
用户 --> manage_layer

'
' 扩展关系（extend）带扩展点和条件说明
'

' 扩展点 EP1: 图形已被选中并显示控制点，用户拖动控制点或点击放大/缩小按钮
' 改变图形尺寸 作为 选择图形 的扩展，在控制点拖动或点击缩放按钮时触发
select_shape ..> resize_shape : extend
note on link
  扩展点 EP1: 图形已被选中并显示控制点
  触发条件：用户拖动控制点或点击“放大/缩小”按钮
end note

' 扩展点 EP2: 图形已被选中，用户在图形内部按下并拖动
' 移动图形 作为 选择图形 的扩展，在选中后内部拖动时触发
select_shape ..> move_shape : extend
note on link
  扩展点 EP2: 图形已被选中
  触发条件：用户在选中图形内部按下鼠标并拖动
end note

'
' 包含关系（include）因果说明
'

' 创建图形必须包含选择图形类型（隐含在流程中，但属于创建的一部分）
' 但根据需求，“选择图形类型”是创建的前提操作，不独立成用例，故不单独建模

' 选择图形 是 删除图形 的前提
' 删除图形 必须在图形被选择之后执行
delete_shape .> select_shape : include
' 因为：删除图形前必须先选择图形

' 管理图层 操作会重置图形创建状态（如选择框重置为矩形），但不影响核心行为结构
' 根据约束，所有图形操作作用于当前图层，因此创建、选择、删除等均隐式依赖当前图层状态
' 但“管理图层”本身不直接包含“选择图形”等，仅影响上下文，故无 include

' 创建图层 后自动设为当前图层，并重置创建状态
' 创建图层 包含了初始化当前图层状态的行为
create_layer .> manage_layer : include
' 因为：创建新图层后需将其设为当前图层，属于管理图层功能的一部分（切换/设定当前）

@enduml
